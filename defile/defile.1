.TH defile 1 "18 January 2004" "version 1.0" "BLAST UTILITIES"
.SH NAME
defile \(em convert a MCP writen framefile into a dirfile
.SH SYNOPSIS
.B defile 
.RB [\  \-c\  |
.BR \-\-curfile\  |
.B \-C
.IR name\  |
.BI \-\-curfile-name= name
]
.RB [\  \-f\  |
.BR \-\-force-framefile\  ]
.RB [\  \-p\  |
.BR \-\-persistant\  ]
.RB [\  \-r\  |
.BR \-\-remounted-source\  |
.BI \-\-remounted-using= path
]
.RB [\  \-s
.IR size\  |
.BI \-\-suffix-size= size
]
.RB [\  \-\-help\  ]
.RB [\  \-\-version\  ]
.RB [\  \-\-\  ]
.I "source"
.RI [\  directory\  ]

.SH DESCRIPTION
.B defile
converts a framefile created by
.B mcp
into a readable dirfile.
.I source
is typically the name of the first chunk of the framefile to convert.
However, if given the name of a curfile for
.IR source ,
.B defile
will use that as an indirect pointer to the framefile.
.PP
You have the option of specifing the name of the destination dirfile
.I directory
or, alternately, the name of the dirfile's parent
.IR directory .
See
.B OUTPUT PATH
below for a description on how
.B defile
determines whether
.I directory
is the destination dirfile or its parent directory, as well as information on
how
.B defile
chooses what to call the output dirfile.
.PP
.B defile
can convert both finished framefiles and ones which are still being writen
to by
.BR mcp .
For notes on running
.B defile
on framefiles which are still being writen to, see the
.B PERSISTANT MODE
section.

.SH OPTIONS
.PP
.BI \-C\  name
or
.BI \-\-curfile-name= name
.RS
Same as (and implies)
.BR \-c ,
but use
.I name
for the name of the curfile instead of the default.
.RE
.TP
.BR \-c\  or\  \-\-curfile
Write a curfile pointing to the output dirfile.  The default curfile name is
generally
.BR /data/etc/defile.cur ,
but see
.BR "COMPILE TIME DEFAULTS" .
To use a different name for the curfile, see the
.B \-C
option.
.TP
.BR \-f\  or\  \-\-force-framefile
Always assume
.I source
is a framefile, even when it looks like a curfile.
.TP
.BR \-p\  or\  \-\-persistant
Upon reaching the end of the framefile, don't exit but wait for more data to
be added to the file.  For use when reading a framefile that is concurrently
being written to by
.BR mcp .
See
.B PERSISTANT MODE
for more information.
.TP
.BR \-r\  or\  \-\-remounted-source
If
.I source
is a curfile, assume that the file it refers to has been mounted in a different
location than the path given in the curfile.  By default
.B defile
will typically look for the framefile in the directory
.B ../rawdir
relative to the location of the
.I source
curfile, but see
.BR "COMPILE TIME DEFAULTS" .
If you want to specify a different remounted location for the framefile, see the
.B \-\-remounted-using
option.  This option does nothing if
.I source
is not a curfile.
.TP
.BI \-\-remounted-using= path
Same as (and implies)
.BR \-r ,
but use
.I path
as the location for the framefile.
.I path
may be either an absolute path or a path relative to the location of the
.I source
curfile.
.PP
.BI \-s\  size
or
.BI \-\-suffix-size= size
.RS
Assume that the suffix of the framefile (the portion of the filename which is
incremented as a hexidecimal number) is no larger than
.I size
characters.  This option only is useful if the character immediately preceeding
the suffix is a hexidecimal digit and you expect the suffix will overflow.
.RE
.TP
.B \-\-help
Show the usage summary and exit.
.TP
.B \-\-version
Show the version information and exit.
.TP
.BR \-F " or " \-\-preformat
Format only - do not display.
.TP
.B \-\-
Indicates that everything following the
.B \-\-
is an argument, even if it begins with a
.BR \- .

.SH "OUTPUT PATH"
If
.I directory
does not exist,
.B defile
assumes that it should be used as the name of the output dirfile.
.PP
If
.I directory
does exist, it is used as the parent directory of the dirfile.  The dirfile
created in this directory is given the same name as the source framefile
(without the suffixed hexidecimal chunk counter).
.PP
If
.I directory
is omitted, the dirfile is named as above and made a subdirectory of a default
location, typically
.BR /data/rawdir ,
but see
.BR "COMPILE TIME DEFAULTS" .
.PP
See also
.B "PERSISTANT MODE"
for information on how that mode affects the output dirfile name.

.SH "PERSISTANT MODE"
When running in persistant mode (with the
.B \-p
switch),
.B defile
will periodically check for additional data in the framefile.  If the
.I source
was a curfile, it will also refer back to this to see if it has changed as well.
If it has, and if the name for the output dirfile was not explitily given on
the command line, it will start writing a new dirfile with the appropriate name.

.SH "COMPILE TIME DEFAULTS"
The following defaults may be changed at compile time from their typical values:
.IP \(bu
default curfile name: 
.B /data/etc/defile.cur
.IP \(bu
default remount path:
.B ../rawdir
.IP \(bu
default output path:
.B /data/rawdir
.PP
If they have been changed by your system administrator, this man page may not
reflect reality.  To see the actual values of these defaults, use
.BR "defile --help " .
.SH AUTHOR
D. V. Wiebe (dwiebe@physics.utoronto.ca)
